---
layout: post
title: 'Reporting Errors in Cross Post Part 2'
category: programming
tags: [ios, cross post]
---
Yesterday I talked about [options for reporting errors][post] (and statuses) from the server back to the Cross Post app. Later I came up with a third option, which I like the best...hosting the error reports on [Cloud Files][cloudfiles].

The Cross Post server is scalable, which means I cannot rely on the server's file system. Data on the file system for one server is not synced to the other servers, and it's possible that the server reporting the error is not the same server as the one that caught the error.

The obvious solution is to use a database server, but using a database server is overkill for Cross Post. But as I thought about it more I realized I all I need is a scalable file system, and that's exactly what cloud storage systems like [S3][s3] and [Cloud Files][cloudfiles] do. They provide a scalable file storage system.

I came to this realization while thinking about how a CMS in a scalable environment might store uploaded files. Uploaded files would likely be stored on a scalable file storage system like S3. And that's exactly what I need for reporting errors, a scalable file system. As I keep saying, a database is overkill for the current needs of Cross Post.

## Cloud Files

So why Cloud Files instead of S3? Two reasons. 1) I already use Cloud Files as my CDN for my websites. And 2) the price. I don't expect to have a lot of error reports, and once the error has been reported to the app the report is deleted, so I estimate my total storage cost will be pennies.

A GB of Cloud Files storage is only 10 cents a month, and bandwidth is only 12 cents per GB per month. The total space needed for my error reports will certainly be less than a GB each month, so my estimated cost is only 22 cents per month, well within an affordable range for a snowboard bum like me.

## The How Tos

So exactly how will this work? Cross Post sends a payload to the server. Once the server receives the payload the HTTP connection ends. The server then processes the payload posting the status update and photos to the selected social networks.

If an error occurs while posting to a social network, it is captured and stored in a JSON file. The file name is the unique id generated by the Cross Post app when packaging up the payload. The server will then take the JSON file and post it to Cloud Files. The next time the Cross Post app is launched, it will check Cloud Files to see if an error report exists. If it does, then the app will report the error to the user, and it will send a request to the Cross Post server telling it to delete the error report from Cloud Files[^deletefile].

So what happens if an error occurred and the person never launches Cross Post ever again? For starters I'll be sad, but with regards to the error report I can set an expiration date on the file, say 30 days. Cloud Files will take care of deleting the file when it expires. This means less work for my server and less code for me to write.

## Not Just For Errors

What I like about the approach is that it is not limited to reporting errors. I can use this approach to report any status back to the app, though at the moment the only status type I need to report is an error status. I subscribe to the "no news is good news" mindset meaning that once the server receives the payload, unless an error is reported, it's safe to assume the post was sent to the different social networks without a problem.

[post]: http://www.thecave.com/2014/09/14/reporting-errors-in-cross-post/
[cloudfiles]: http://www.rackspace.com/cloud/files/
[s3]: http://aws.amazon.com/s3/
[^deletefile]: I let the Cross Post server delete the file from Cloud Files CDN so I don't have to include the api key in the iOS app.
